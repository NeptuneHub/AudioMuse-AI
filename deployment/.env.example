# =============================================================================
# AudioMuse-AI Configuration
# =============================================================================
# Copy this file to `.env` and fill in the values that match your setup.
# Docker Compose files under deployment/ read these variables to keep settings in one place.
#
# QUICK START:
#   1. Copy this file: cp .env.example .env
#   2. Set your media provider settings below (Jellyfin, Navidrome, etc.)
#   3. Start the containers: docker-compose -f docker-compose-unified.yaml up -d
#   4. Open http://localhost:8000 and complete the setup wizard
#
# IMPORTANT:
# 1. This file must be named exactly ".env" (not .env.txt or .env.example)
# 2. It must be in the SAME directory as your docker-compose-*.yaml file
# 3. Do NOT use spaces around the = sign
# 4. Do NOT use quotes around values (unless required by the value itself)
# 5. After editing, restart containers: docker-compose down && docker-compose up -d
#
# SPECIAL CHARACTERS IN VALUES:
# If your password or API key contains special characters like: $ ` " ' \ # ! & * ( ) [ ] { } | ; < > ?
# you may need to:
#   - Avoid quotes entirely: GEMINI_API_KEY=AIza$pecial!Key  (usually works)
#   - OR use single quotes if the value has $: GEMINI_API_KEY='AIza$pecial!Key'
#   - OR escape with backslash: GEMINI_API_KEY=AIza\$pecial\!Key
# Most problematic characters: $ (variable expansion), ` (command substitution), " (string delimiter)
#
# TROUBLESHOOTING:
# If API keys don't work, verify:
#   - File is named ".env" exactly (check with: ls -la)
#   - No spaces: GEMINI_API_KEY=AIza... (not GEMINI_API_KEY = "AIza...")
#   - No unescaped special characters (especially $ ` " ')
#   - Restart containers after changing this file
# If all else fails, try hardcoding the value directly in docker-compose-*.yaml to isolate the issue

# =============================================================================
# MEDIA SERVER PROVIDER
# =============================================================================
# Choose your primary media provider. Additional providers can be configured
# via the web-based setup wizard at http://localhost:8000/setup
#
# Options: jellyfin, navidrome, lyrion, mpd, emby, localfiles
# Default: localfiles (scans local music directory)
MEDIASERVER_TYPE=localfiles

# --- Local Files Provider ---
# Path to your music library (mounted into the container as /music)
MUSIC_PATH=/path/to/your/music
LOCALFILES_MUSIC_DIRECTORY=/music
LOCALFILES_PLAYLIST_DIR=/music/playlists
# Supported formats (comma-separated, including the dot)
LOCALFILES_FORMATS=.mp3,.flac,.ogg,.m4a,.mp4,.wav,.wma,.aac,.opus
# Scan subdirectories for music files
LOCALFILES_SCAN_SUBDIRS=true

# --- Jellyfin ---
JELLYFIN_URL=http://jellyfin.example.com:8096
JELLYFIN_USER_ID=YOUR_JELLYFIN_USER_ID
JELLYFIN_TOKEN=YOUR_JELLYFIN_API_TOKEN

# --- Emby ---
EMBY_URL=
EMBY_USER_ID=
EMBY_TOKEN=

# --- Navidrome ---
NAVIDROME_URL=
NAVIDROME_USER=
NAVIDROME_PASSWORD=

# --- Lyrion (formerly LMS) ---
LYRION_URL=http://lyrion.example.com:9000

# --- MPD (Music Player Daemon) ---
MPD_HOST=localhost
MPD_PORT=6600
MPD_PASSWORD=
MPD_MUSIC_DIRECTORY=/var/lib/mpd/music

# =============================================================================
# DATABASE & INFRASTRUCTURE
# =============================================================================
POSTGRES_USER=audiomuse
POSTGRES_PASSWORD=audiomusepassword
POSTGRES_DB=audiomusedb
POSTGRES_PORT=5432
POSTGRES_HOST=postgres
REDIS_URL=redis://redis:6379/0
REDIS_PORT=6379

# =============================================================================
# WEB SERVER
# =============================================================================
FRONTEND_PORT=8000
WORKER_PORT=8029
# Timezone (examples: UTC, Europe/Berlin, America/Los_Angeles)
TZ=UTC

# =============================================================================
# SPLIT DEPLOYMENT (Remote Worker Configuration)
# =============================================================================
# Use these settings when running workers on a separate machine from the server.
#
# DEPLOYMENT OPTIONS:
#   1. UNIFIED (default) - Server and worker on same machine
#      CPU:    docker-compose-unified.yaml (uses :latest image)
#      NVIDIA: docker-compose-unified-nvidia.yaml (uses :latest-nvidia image)
#      Leave WORKER_* settings at defaults
#
#   2. SPLIT - Server and worker on different machines
#      Server machine: docker-compose-server.yaml
#      Worker machine: docker-compose-worker-cpu.yaml (CPU) or
#                      docker-compose-worker-nvidia.yaml (NVIDIA GPU)
#      Configure WORKER_* settings below on worker machine
#
# On the WORKER machine, set these to point to the SERVER machine:
#
# Redis URL on server (replace SERVER_IP with your server's IP/hostname)
# Format: redis://[password@]host:port/db
# Examples:
#   WORKER_REDIS_URL=redis://192.168.1.100:6379/0
#   WORKER_REDIS_URL=redis://:mypassword@192.168.1.100:6379/0
WORKER_REDIS_URL=redis://redis:6379/0
#
# PostgreSQL host on server (replace with your server's IP/hostname)
# Examples:
#   WORKER_POSTGRES_HOST=192.168.1.100
#   WORKER_POSTGRES_HOST=my-server.local
WORKER_POSTGRES_HOST=postgres

# =============================================================================
# NVIDIA GPU (for docker-compose-unified-nvidia.yaml)
# =============================================================================
# GPU device ID (usually 0 for single GPU systems)
NVIDIA_GPU_ID=0
# Enable GPU-accelerated clustering using RAPIDS cuML
# Automatically falls back to CPU if GPU is unavailable
USE_GPU_CLUSTERING=false

# =============================================================================
# ML FEATURES
# =============================================================================
# CLAP Text Search - natural language music search
# Allows queries like "upbeat summer songs" or "relaxing piano music"
# Disable to save memory (~750MB) on systems with limited RAM
CLAP_ENABLED=true

# =============================================================================
# AI PLAYLIST NAMING (Optional)
# =============================================================================
# Choose an AI provider for creative playlist names: NONE, OLLAMA, OPENAI, GEMINI, MISTRAL
AI_MODEL_PROVIDER=NONE

# --- OpenAI / OpenRouter Configuration ---
# For OpenRouter (https://openrouter.ai):
#   1. Get API key from https://openrouter.ai/keys
#   2. Set OPENAI_API_KEY to your OpenRouter API key
#   3. Set OPENAI_SERVER_URL to https://openrouter.ai/api/v1/chat/completions
#   4. Set OPENAI_MODEL_NAME to your desired model (e.g., openai/gpt-4, meta-llama/llama-3.2-3b-instruct:free)
# For OpenAI directly: Use https://api.openai.com/v1/chat/completions and your OpenAI API key
OPENAI_API_KEY=
OPENAI_SERVER_URL=https://openrouter.ai/api/v1/chat/completions
OPENAI_MODEL_NAME=
# Delay between API calls to respect rate limits (default: 7 seconds)
OPENAI_API_CALL_DELAY_SECONDS=7

# --- Other AI Provider API Keys ---
GEMINI_API_KEY=
MISTRAL_API_KEY=
